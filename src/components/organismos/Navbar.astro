---
import Button from "../atomos/Button";
import { Menu, X, ChevronDown } from "lucide-react";

const links = [
  { name: "Inicio", href: "/" },
  {
    name: "Sobre Nosotros",
    href: "/sobre-nosotros",
    dropdown: [
      { name: "Nuestra Historia", href: "/sobre-nosotros" },
      { name: "Qué Hacemos", href: "/que-hacemos" },
      { name: "Nuestro Equipo", href: "/equipo" },
    ],
  },
  { name: "Proyectos", href: "/proyectos" },
  { name: "Cómo Ayudar", href: "/como-ayudar" },
  { name: "Eventos", href: "/eventos" },
  { name: "Galería", href: "/galeria" },
  { name: "Contacto", href: "/contacto" },
];
---

<nav
  class="fixed top-0 w-full bg-white/80 backdrop-blur-md z-50 border-b border-primary-border transition-all duration-300"
  id="navbar"
>
  <div class="mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex h-20 items-center justify-between">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-3 group">
        <img
          src="/logo.jpeg"
          class="h-10 w-10 rounded-xl shadow-sm group-hover:shadow-md transition-all duration-300"
          alt="Logo Fundación Simi Sumaq"
        />
        <div class="flex flex-col leading-none">
          <span
            class="text-lg font-bold text-primary-100 group-hover:text-primary-200 transition-colors"
            >Asociación</span
          >
          <span
            class="text-lg font-bold text-primary-200 group-hover:text-primary-100 transition-colors"
            >Simi Sumaq</span
          >
        </div>
      </a>

      <!-- Desktop Menu -->
      <div class="hidden lg:flex items-center gap-1">
        {
          links.map((link) =>
            link.dropdown ? (
              <div class="relative group">
                <button class="flex items-center gap-1 px-4 py-2 text-sm font-medium text-primary-texto hover:text-primary-100 hover:bg-primary-bg-claro rounded-lg transition-all duration-200 cursor-pointer">
                  {link.name}
                  <ChevronDown className="h-4 w-4 transition-transform group-hover:rotate-180" />
                </button>
                <div class="absolute left-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-primary-border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform translate-y-2 group-hover:translate-y-0">
                  <div class="py-2">
                    {link.dropdown.map((sublink) => (
                      <a
                        href={sublink.href}
                        class="block px-4 py-2 text-sm text-primary-texto hover:bg-primary-bg-claro hover:text-primary-100"
                      >
                        {sublink.name}
                      </a>
                    ))}
                  </div>
                </div>
              </div>
            ) : (
              <a
                href={link.href}
                class="px-4 py-2 text-sm font-medium text-primary-texto hover:text-primary-100 hover:bg-primary-bg-claro rounded-lg transition-all duration-200"
              >
                {link.name}
              </a>
            )
          )
        }
        <div class="ml-4 pl-4 border-l border-primary-border">
          <Button
            href="/como-ayudar"
            size="default"
            variant="primary"
            class="font-semibold shadow-md hover:shadow-lg"
          >
            Donar Ahora
          </Button>
        </div>
      </div>

      <!-- Mobile Menu Button -->
      <div class="lg:hidden">
        <button
          id="mobile-menu-btn"
          class="p-2 text-primary-texto hover:text-primary-100 hover:bg-primary-bg-claro rounded-lg transition-colors"
          aria-label="Abrir menú"
        >
          <Menu className="h-6 w-6" id="menu-icon" />
          <X className="h-6 w-6 hidden" id="close-icon" />
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="hidden lg:hidden bg-white border-t border-primary-border absolute w-full left-0 shadow-lg max-h-[calc(100vh-80px)] overflow-y-auto"
  >
    <div class="px-4 pt-2 pb-6 space-y-2">
      {
        links.map((link) =>
          link.dropdown ? (
            <div class="space-y-1">
              <div class="px-4 py-3 text-base font-medium text-primary-textoTitle border-b border-primary-border/50">
                {link.name}
              </div>
              <div class="pl-4 space-y-1">
                {link.dropdown.map((sublink) => (
                  <a
                    href={sublink.href}
                    class="block px-4 py-2 text-sm font-medium text-primary-texto hover:text-primary-100 hover:bg-primary-bg-claro rounded-lg transition-colors"
                  >
                    {sublink.name}
                  </a>
                ))}
              </div>
            </div>
          ) : (
            <a
              href={link.href}
              class="block px-4 py-3 text-base font-medium text-primary-texto hover:text-primary-100 hover:bg-primary-bg-claro rounded-lg transition-colors"
            >
              {link.name}
            </a>
          )
        )
      }
      <div class="pt-4 mt-4 border-t border-primary-border">
        <Button
          href="/como-ayudar"
          size="lg"
          variant="primary"
          class="w-full font-semibold justify-center"
        >
          Donar Ahora
        </Button>
      </div>
    </div>
  </div>
</nav>

<script>
  const mobileMenuBtn = document.getElementById("mobile-menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");

  if (mobileMenuBtn && mobileMenu && menuIcon && closeIcon) {
    mobileMenuBtn.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
      menuIcon.classList.toggle("hidden");
      closeIcon.classList.toggle("hidden");
    });

    // Close menu when clicking a link
    const mobileLinks = mobileMenu.querySelectorAll("a");
    mobileLinks.forEach((link) => {
      link.addEventListener("click", () => {
        mobileMenu.classList.add("hidden");
        menuIcon.classList.remove("hidden");
        closeIcon.classList.add("hidden");
      });
    });
  }
</script>
